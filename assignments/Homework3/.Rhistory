legend.position="bottom")
ggplot(orState, aes(long, lat, group = group, fill = hsgrad, income)) +
geom_polygon() +
borders("state", colour= "black", size = 0.5) +
ggtitle("Population Density (1000 people/square miles) \n of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom")
p1 <- ggplot(orState, aes(long, lat, group = group, fill = hsgrad, income)) +
geom_polygon() +
borders("state", colour= "black", size = 0.5) +
ggtitle("Population Density (1000 people/square miles) \n of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom")
p2 <- ggplot(orState, aes(long, lat, group = group, fill = income)) +
geom_polygon() +
borders("state", colour= "black", size = 0.5) +
ggtitle("Population Density (1000 people/square miles) \n of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom")
grid.arrange(p1, p2, ncol = 1, nrow = 2)
p1 <- ggplot(orState, aes(long, lat, group = group, fill = hsgrad, income)) +
geom_polygon() +
borders("state", colour= "black", size = 0.5) +
ggtitle("Population Density (1000 people/square miles) \n of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom") +
scale_fill_continuous(low='thistle2', high='darkred', guide='colorbar')
p2 <- ggplot(orState, aes(long, lat, group = group, fill = income)) +
geom_polygon() +
borders("state", colour= "black", size = 0.5) +
ggtitle("Population Density (1000 people/square miles) \n of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom")
grid.arrange(p1, p2, ncol = 1, nrow = 2)
p1 <- ggplot(orState, aes(long, lat, group = group, fill = hsgrad, income)) +
geom_polygon() +
borders("state", colour= "black", size = 0.5) +
ggtitle("Population Density (1000 people/square miles) \n of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom") +
scale_fill_continuous(low='dardred', high='thistle2', guide='colorbar')
p2 <- ggplot(orState, aes(long, lat, group = group, fill = income)) +
geom_polygon() +
borders("state", colour= "black", size = 0.5) +
ggtitle("Population Density (1000 people/square miles) \n of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom")
grid.arrange(p1, p2, ncol = 1, nrow = 2)
p1 <- ggplot(orState, aes(long, lat, group = group, fill = hsgrad, income)) +
geom_polygon() +
borders("state", colour= "black", size = 0.5) +
ggtitle("Population Density (1000 people/square miles) \n of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom") +
scale_fill_continuous(low='darkred', high='thistle2', guide='colorbar')
p2 <- ggplot(orState, aes(long, lat, group = group, fill = income)) +
geom_polygon() +
borders("state", colour= "black", size = 0.5) +
ggtitle("Population Density (1000 people/square miles) \n of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom")
grid.arrange(p1, p2, ncol = 1, nrow = 2)
p1 <- ggplot(orState, aes(long, lat, group = group, fill = hsgrad, income)) +
geom_polygon() +
borders("state", colour= "black", size = 0.5) +
ggtitle("Population Density (1000 people/square miles) \n of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom") +
scale_fill_continuous(low='darkred', high='thistle2', guide='colorbar')
p2 <- ggplot(orState, aes(long, lat, group = group, fill = income)) +
geom_polygon() +
borders("state", colour= "black", size = 0.5) +
ggtitle("Population Density (1000 people/square miles) \n of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom")
grid.arrange(p1, p2, ncol = 2, nrow = 1)
p1 <- ggplot(orState, aes(long, lat, group = group, fill = hsgrad, income)) +
geom_polygon() +
borders("state", colour= "black", size = 0.5) +
ggtitle("Income of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom") +
scale_fill_continuous(low='darkred', high='thistle2', guide='colorbar')
p2 <- ggplot(orState, aes(long, lat, group = group, fill = income)) +
geom_polygon() +
borders("state", colour= "black", size = 0.5) +
ggtitle("HS Grad of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom")
grid.arrange(p1, p2, ncol = 2, nrow = 1)
p1 <- ggplot(orState, aes(long, lat, group = group, fill = hsgrad, income)) +
geom_polygon() +
borders("state", colour= "black", size = 0.2) +
ggtitle("Income of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom") +
scale_fill_continuous(low='darkred', high='thistle2', guide='colorbar')
p2 <- ggplot(orState, aes(long, lat, group = group, fill = income)) +
geom_polygon() +
borders("state", colour= "black", size = 0.2) +
ggtitle("HS Grad of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom")
grid.arrange(p1, p2, ncol = 2, nrow = 1)
p1 <- ggplot(orState, aes(long, lat, group = group, fill = hsgrad, income)) +
geom_polygon() +
borders("state", colour= "white", size = 0.2) +
ggtitle("Income of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom") +
scale_fill_continuous(low='darkred', high='thistle2', guide='colorbar')
p2 <- ggplot(orState, aes(long, lat, group = group, fill = income)) +
geom_polygon() +
borders("state", colour= "white", size = 0.2) +
ggtitle("HS Grad of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom")
grid.arrange(p1, p2, ncol = 2, nrow = 1)
us <- map_data("state")
arr <- USArrests %>%
add_rownames("region") %>%
mutate(region=tolower(region))
View(arr)
View(arr)
USArrests
gg <- ggplot()
gg <- gg + geom_map(data=us, map=us,
aes(x=long, y=lat, map_id=region),
fill="#ffffff", color="#ffffff", size=0.15)
gg <- gg + geom_map(data=arr, map=us,
aes(fill=Murder, map_id=region),
color="#ffffff", size=0.15)
gg <- gg + scale_fill_continuous(low='thistle2', high='darkred',
guide='colorbar')
gg <- gg + labs(x=NULL, y=NULL)
gg <- gg + coord_map("albers", lat0 = 39, lat1 = 45)
gg <- gg + theme(panel.border = element_blank())
gg <- gg + theme(panel.background = element_blank())
gg <- gg + theme(axis.ticks = element_blank())
gg <- gg + theme(axis.text = element_blank())
gg
install.packages("mapproj")
us <- map_data("state")
arr <- USArrests %>%
add_rownames("region") %>%
mutate(region=tolower(region))
gg <- ggplot()
gg <- gg + geom_map(data=us, map=us,
aes(x=long, y=lat, map_id=region),
fill="#ffffff", color="#ffffff", size=0.15)
gg <- ggplot()
gg <- gg + geom_map(data=us, map=us,
aes(long, lat, map_id=region),
fill="#ffffff", color="#ffffff", size=0.15)
gg <- gg + geom_map(data=arr, map=us,
aes(fill=Murder, map_id=region),
color="#ffffff", size=0.15)
gg <- gg + scale_fill_continuous(low='thistle2', high='darkred',
guide='colorbar')
gg <- gg + labs(x=NULL, y=NULL)
gg <- gg + coord_map("albers", lat0 = 39, lat1 = 45)
gg <- gg + theme(panel.border = element_blank())
gg <- gg + theme(panel.background = element_blank())
gg <- gg + theme(axis.ticks = element_blank())
gg <- gg + theme(axis.text = element_blank())
gg
p1 <- ggplot(orState, aes(long, lat, group = group, fill = hsgrad, income)) +
geom_polygon() +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("Income of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom") +
scale_fill_continuous(low='darkred', high='thistle2', guide='colorbar')
p2 <- ggplot(orState, aes(long, lat, group = group, fill = income)) +
geom_polygon() +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("HS Grad of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom")
grid.arrange(p1, p2, ncol = 2, nrow = 1)
gg <- ggplot()
gg <- gg + geom_map(data=us, map=us,
aes(long, lat, map_id=region),
fill="#ffffff", color="#ffffff", size=0.15)
gg <- gg + geom_map(data=arr, map=us,
aes(fill=Murder, map_id=region),
color="#ffffff", size=0.15)
gg <- gg + scale_fill_continuous(low='thistle2', high='darkred',
guide='colorbar')
gg <- gg + labs(x=NULL, y=NULL)
gg <- gg + coord_map("albers", lat0 = 39, lat1 = 45)
gg <- gg + theme(panel.border = element_blank())
gg <- gg + theme(panel.background = element_blank())
gg <- gg + theme(axis.ticks = element_blank())
gg <- gg + theme(axis.text = element_blank())
gg
p1 <- ggplot(orState, aes(long, lat, group = group, fill = hsgrad, income)) +
geom_polygon() +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("Income of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank()) +
scale_fill_continuous(low='darkred', high='thistle2', guide='colorbar')
p2 <- ggplot(orState, aes(long, lat, group = group, fill = income)) +
geom_polygon() +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("HS Grad of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank())
grid.arrange(p1, p2, ncol = 2, nrow = 1)
ggplot(orState, aes(long, lat, map_id = region, fill = income)) +
geom_polygon() +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("HS Grad of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank())
ggplot(orState, aes(long, lat, map_id = region, fill = income)) +
geom_map() +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("HS Grad of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank())
us <- map_data("state")
ggplot(orState, aes(long, lat, map_id = region, fill = income)) +
geom_map(map = us) +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("HS Grad of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank())
us <- map_data("state")
ggplot(orState, aes(long, lat, map_id = region, fill = income)) +
geom_map(map = us, data=us) +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("HS Grad of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank())
myState <-as.data.frame(cbind(state.x77, region = state.region))
myState <- cbind(myState, regionname = levels(state.region)[state.region])
colnames(myState) <- tolower(colnames(myState))
myState$statename <- tolower(rownames(myState))
myState$`Population \n Density` <- myState$population / myState$area
colnames(myState)[6] <- "hsgrad"
colnames(myState)[4] <- "lifeexp"
stateMap <- map_data("state")
colnames(stateMap)[5] <- "statename"
myStateMap <- merge(stateMap, myState)
orState <- myStateMap[order(myStateMap$order), ]
ggplot(orState, aes(long, lat, group = group, fill = `Population \n Density`)) +
geom_polygon() +
borders("state", colour= "white", size = 0.5) +
annotate("text",label = "NJ \n = 0.97", x = -70, y = 40) +
annotate("text",label = "CA \n = 0.14", x = -130, y = 37.5) +
annotate("text",label = "Alaska = 0.0006", x = -120, y = 50) +
ggtitle("Population Density (1000 people/square miles) \n of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom")
a
a
ggplot(orState, aes(long, lat, map_id = region, fill = income)) +
geom_map(map = us, data=orState) +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("HS Grad of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank())
ggplot(orState, aes(long, lat, map_id = region, fill = income)) +
geom_map(map = orState, data=orState) +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("HS Grad of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank())
p3 <- ggplot(orState, aes(long, lat, map_id = region, fill = illiteracy)) +
geom_map(map = orState, data=orState) +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("Illiteracy of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank())
p4 <- ggplot(orState, aes(long, lat, map_id = region, fill = income)) +
geom_map(map = orState, data=orState) +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("Illiteracy of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank())
p1 <- ggplot(orState, aes(long, lat, group = group, fill = hsgrad, income)) +
geom_polygon() +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("Income of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank()) +
scale_fill_continuous(low='darkred', high='thistle2', guide='colorbar')
p2 <- ggplot(orState, aes(long, lat, group = group, fill = income)) +
geom_polygon() +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("HS Grad of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank())
p3 <- ggplot(orState, aes(long, lat, map_id = region, fill = illiteracy)) +
geom_map(map = orState, data=orState) +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("Illiteracy of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank())
p4 <- ggplot(orState, aes(long, lat, map_id = region, fill = income)) +
geom_map(map = orState, data=orState) +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("Illiteracy of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank())
grid.arrange(p1, p2, p3, p4, ncol = 2, nrow = 2)
p1 <- ggplot(orState, aes(long, lat, group = group, fill = hsgrad, income)) +
geom_polygon() +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("Income of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank()) +
scale_fill_continuous(low='darkred', high='thistle2', guide='colorbar')
p2 <- ggplot(orState, aes(long, lat, group = group, fill = income)) +
geom_polygon() +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("HS Grad of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank())
p3 <- ggplot(orState, aes(long, lat, map_id = region, fill = illiteracy)) +
geom_map(map = orState, data=orState) +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("Illiteracy of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank())
p4 <- ggplot(orState, aes(long, lat, map_id = region, fill = income)) +
geom_map(map = orState, data=orState) +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("Illiteracy of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank()) +
scale_fill_continuous(low='darkred', high='thistle2', guide='colorbar')
grid.arrange(p1, p2, p3, p4, ncol = 2, nrow = 2)
p1 <- ggplot(orState, aes(long, lat, group = group, fill = hsgrad, income)) +
geom_polygon() +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("Income of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank()) +
scale_fill_continuous(low='darkred', high='thistle2', guide='colorbar')
p2 <- ggplot(orState, aes(long, lat, group = group, fill = income)) +
geom_polygon() +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("HS Grad of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank())
p3 <- ggplot(orState, aes(long, lat, map_id = region, fill = illiteracy)) +
geom_map(map = orState, data=orState) +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("Illiteracy of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank()) +
scale_fill_continuous(low='darkred', high='thistle2', guide='colorbar')
p4 <- ggplot(orState, aes(long, lat, map_id = region, fill = income)) +
geom_map(map = orState, data=orState) +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("Illiteracy of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank()) +
grid.arrange(p1, p2, p3, p4, ncol = 2, nrow = 2)
p1 <- ggplot(orState, aes(long, lat, group = group, fill = hsgrad, income)) +
geom_polygon() +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("Income of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank()) +
scale_fill_continuous(low='darkred', high='thistle2', guide='colorbar')
p2 <- ggplot(orState, aes(long, lat, group = group, fill = income)) +
geom_polygon() +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("HS Grad of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank())
p3 <- ggplot(orState, aes(long, lat, map_id = region, fill = illiteracy)) +
geom_map(map = orState, data=orState) +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("Illiteracy of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank()) +
scale_fill_continuous(low='darkred', high='thistle2', guide='colorbar')
p4 <- ggplot(orState, aes(long, lat, map_id = region, fill = income)) +
geom_map(map = orState, data=orState) +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("Illiteracy of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5),
legend.position="bottom",
panel.background = element_blank())
grid.arrange(p1, p2, p3, p4, ncol = 2, nrow = 2)
knitr::opts_chunk$set(echo = TRUE)
library("plyr")
library("tidyr")
library("lattice")
library("rgl")
setwd("/Users/xinhuang/Google Drive/CSC 522 R Language Programming /Homework3")
westState <- myState %>%
subset(regionName == 'West') %>%
mutate(density = Population / Area)
myState <-as.data.frame(cbind(state.x77, region = state.region))
myState <- cbind(myState, regionName = levels(state.region)[state.region])
myState$StateName <- rownames(myState)
colnames(myState)[6] <- "HSgrad"
xyplot(Area ~ Population | as.factor(regionName),
main = "State Population as a Function of Area",
myState,
layout = c(4, 1),
panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
```{r echo = TRUE, fig=TRUE, fig.align='center'}
myState <-as.data.frame(cbind(state.x77, region = state.region))
myState <- cbind(myState, regionName = levels(state.region)[state.region])
myState$StateName <- rownames(myState)
colnames(myState)[6] <- "HSgrad"
westState <- myState %>%
subset(regionName == 'West') %>%
mutate(density = Population / Area)
westState[order(westdata$density), ]
westState
westState[order(westdata$density), ]
myState <-as.data.frame(cbind(state.x77, region = state.region))
myState <- cbind(myState, regionName = levels(state.region)[state.region])
myState$StateName <- rownames(myState)
colnames(myState)[6] <- "HSgrad"
View(westState)
View(westState)
westState <- myState %>%
subset(regionName == 'West') %>%
mutate(density = Population / Area)
westState[order(westState$density), 11: 12]
ggplot(orState, aes(long, lat, group = group, fill = hsgrad, income)) +
geom_polygon() +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("Income of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5, size = 22),
legend.position="bottom",
panel.background = element_blank()) +
scale_fill_continuous(low='darkred', high='thistle2', guide='colorbar')
ggplot(orState, aes(long, lat, group = group, fill = hsgrad, income)) +
geom_polygon() +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("Income of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5, size = 12),
legend.position="bottom",
panel.background = element_blank()) +
scale_fill_continuous(low='darkred', high='thistle2', guide='colorbar')
ggplot(orState, aes(long, lat, group = group, fill = hsgrad, income)) +
geom_polygon() +
borders("state", colour= "white", size = 0.2) +
coord_map("albers", lat0 = 39, lat1 = 45) +
ggtitle("Income of the USA in 1977") +
theme(plot.title = element_text(hjust = 0.5, size = 10),
legend.position="bottom",
panel.background = element_blank()) +
scale_fill_continuous(low='darkred', high='thistle2', guide='colorbar')
